# ğŸ‰ GitåŸºç¡€æ¶æ„éƒ¨ç½²é…ç½®å®ŒæˆæŠ¥å‘Š

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

å·²å®Œæˆnginxåˆ†æå¹³å°çš„GitåŸºç¡€æ¶æ„é…ç½®ï¼Œå®ç°**é€šè¿‡git clone + docker-compose up -då¿«é€Ÿåœ¨æ–°ç”µè„‘å¯åŠ¨å®Œæ•´åŸºç¡€è®¾æ–½**çš„ç›®æ ‡ã€‚

## âœ… å®Œæˆçš„å·¥ä½œ

### 1. Docker Composeæ¶æ„ä¼˜åŒ–
- **ç²¾ç®€æœåŠ¡é…ç½®**: ä»1350+è¡Œå‡å°‘è‡³593è¡Œ
- **ç§»é™¤å†—ä½™æœåŠ¡**: SeaTunnel Web UIã€Scalephã€DSS/Linkisã€Jupyterã€Airflowç­‰8+ä¸ªæœåŠ¡æ ˆ
- **æœåŠ¡ä¾èµ–ä¼˜åŒ–**: ç®€åŒ–ä¸ºç»„å†…ä¾èµ–å…³ç³»ï¼Œæ”¯æŒçµæ´»çš„å®¹å™¨å¢åˆ 
- **DolphinSchedulerå‡çº§**: æ›´æ–°è‡³3.3.1 Standaloneæ¨¡å¼

### 2. ETLè‡ªåŠ¨å‘ç°åŠŸèƒ½å¢å¼º
- **AutoFileDiscoveryç±»**: æ·»åŠ åˆ°integrated_ultra_etl_controller.py
- **è‡ªåŠ¨ç›‘æ§**: ç©ºé—²æ—¶3åˆ†é’Ÿé—´éš”æ‰«ææ–°æ–‡ä»¶
- **çº¿ç¨‹å®‰å…¨**: å¹¶å‘å¤„ç†ä¿æŠ¤ï¼Œä¿ç•™åŸæœ‰äº¤äº’åŠŸèƒ½
- **æ— ç¼é›†æˆ**: å¤„ç†å®Œæˆåå¯é€‰æ‹©è¿›å…¥è‡ªåŠ¨ç›‘æ§æ¨¡å¼

### 3. æ•°æ®åº“åˆå§‹åŒ–ç³»ç»Ÿ
```bash
# å…³é”®æ–‡ä»¶åˆ—è¡¨
services/n9e/init-scripts/00-init-database.sql    # N9Eå®Œæ•´æ•°æ®åº“ç»“æ„
services/n9e/config/categraf/conf.toml            # Categrafç›‘æ§é…ç½®
services/grafana/datasources/clickhouse.yml       # Grafanaæ•°æ®æºé…ç½®
force-init-databases.sh                           # å¼ºåˆ¶æ•°æ®åº“é‡ç½®å·¥å…·
```

### 4. è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬
- **init-fresh-environment.sh**: æ–°ç¯å¢ƒå®Œæ•´åˆå§‹åŒ–
- **check-config-files.sh**: é…ç½®æ–‡ä»¶å®Œæ•´æ€§æ£€æŸ¥
- **validate-deployment.sh**: éƒ¨ç½²åéªŒè¯å·¥å…·
- **INITIALIZE_GUIDE.md**: è¯¦ç»†éƒ¨ç½²æŒ‡å—

### 5. Gité…ç½®ä¼˜åŒ–
- **ä¿®å¤.gitignore**: ç¡®ä¿å…³é”®Dockeré…ç½®æ–‡ä»¶è¢«è¿½è¸ª
- **é…ç½®æ–‡ä»¶è¿½è¸ª**: æ‰€æœ‰å¿…éœ€çš„é…ç½®æ–‡ä»¶å·²åŠ å…¥ç‰ˆæœ¬æ§åˆ¶
- **æ’é™¤ä¸´æ—¶æ–‡ä»¶**: ä¿æŒä»“åº“æ¸…æ´ï¼Œåªè¿½è¸ªå¿…è¦æ–‡ä»¶

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æ–°ç¯å¢ƒå¿«é€Ÿéƒ¨ç½²
```bash
# 1. å…‹éš†ä»“åº“
git clone <repository-url>
cd nginx-log-analyzer/nginx-analytics-warehouse/docker

# 2. æ£€æŸ¥é…ç½®å®Œæ•´æ€§
./check-config-files.sh

# 3. è‡ªåŠ¨åˆå§‹åŒ–ç¯å¢ƒ
./init-fresh-environment.sh

# 4. éªŒè¯éƒ¨ç½²ç»“æœ
./validate-deployment.sh
```

### æ‰‹åŠ¨éƒ¨ç½²
```bash
# ç›´æ¥å¯åŠ¨ï¼ˆæ¨èåœ¨é…ç½®æ£€æŸ¥åä½¿ç”¨ï¼‰
docker-compose up -d

# å¦‚é‡æ•°æ®åº“é—®é¢˜ï¼Œå¼ºåˆ¶é‡æ–°åˆå§‹åŒ–
./force-init-databases.sh
```

## ğŸŒ æœåŠ¡è®¿é—®åœ°å€

| æœåŠ¡ | åœ°å€ | ç”¨æˆ·å/å¯†ç  | è¯´æ˜ |
|------|------|-------------|------|
| **Grafana** | http://localhost:3000 | admin/admin123 | æ•°æ®å¯è§†åŒ– |
| **Superset** | http://localhost:8088 | - | é«˜çº§æ•°æ®åˆ†æ |
| **DataEase** | http://localhost:8810 | - | BIæŠ¥è¡¨å¹³å° |
| **Nightingale** | http://localhost:17000 | root/root.2020 | ç›‘æ§å‘Šè­¦ |
| **DolphinScheduler** | http://localhost:12345 | - | å·¥ä½œæµè°ƒåº¦ |
| **Spark Master** | http://localhost:8080 | - | è®¡ç®—å¼•æ“ |
| **Flink Dashboard** | http://localhost:8082 | - | æµå¤„ç†å¼•æ“ |

## ğŸ—„ï¸ æ•°æ®åº“è¿æ¥ä¿¡æ¯

| æ•°æ®åº“ | åœ°å€ | ç«¯å£ | ç”¨æˆ·å | å¯†ç  | æ•°æ®åº“å |
|--------|------|------|--------|------|----------|
| **ClickHouse** | localhost | 8123/9000 | analytics_user | analytics_password_change_in_prod | nginx_analytics |
| **N9E MySQL** | localhost | 3308 | root | 1234 | n9e_v6 |
| **DataEase MySQL** | localhost | 3307 | root | Password123@mysql | dataease |
| **PostgreSQL** | localhost | 5433 | superset | superset_password | superset |
| **Redis** | localhost | 6380 | - | redis_password | - |

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸ç”¨æ£€æŸ¥å‘½ä»¤
```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker-compose logs nginx-analytics-nightingale

# é‡å¯ç‰¹å®šæœåŠ¡
docker-compose restart nginx-analytics-grafana

# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tuln | grep -E ":(3000|8088|8810|17000)"
```

### å¸¸è§é—®é¢˜è§£å†³
1. **N9Eæ•°æ®åº“è¡¨ä¸å­˜åœ¨**: è¿è¡Œ `./force-init-databases.sh`
2. **æœåŠ¡å¯åŠ¨å¤±è´¥**: æ£€æŸ¥ç«¯å£å ç”¨ï¼Œç­‰å¾…ä¾èµ–æœåŠ¡å¯åŠ¨
3. **Webç•Œé¢æ— æ³•è®¿é—®**: ç­‰å¾…5-10åˆ†é’Ÿè®©æœåŠ¡å®Œå…¨å¯åŠ¨
4. **é…ç½®æ–‡ä»¶ç¼ºå¤±**: è¿è¡Œ `./check-config-files.sh` æ£€æŸ¥

## ğŸ“ æ ¸å¿ƒæ–‡ä»¶ç»“æ„

```
nginx-analytics-warehouse/docker/
â”œâ”€â”€ docker-compose.yml              # ä¸»è¦æœåŠ¡é…ç½®(593è¡Œ)
â”œâ”€â”€ .env                            # ç¯å¢ƒå˜é‡é…ç½®
â”œâ”€â”€ INITIALIZE_GUIDE.md             # è¯¦ç»†éƒ¨ç½²æŒ‡å—
â”œâ”€â”€ init-fresh-environment.sh       # æ–°ç¯å¢ƒè‡ªåŠ¨åˆå§‹åŒ–
â”œâ”€â”€ force-init-databases.sh         # æ•°æ®åº“å¼ºåˆ¶é‡ç½®
â”œâ”€â”€ check-config-files.sh           # é…ç½®å®Œæ•´æ€§æ£€æŸ¥
â”œâ”€â”€ validate-deployment.sh          # éƒ¨ç½²éªŒè¯å·¥å…·
â””â”€â”€ services/
    â”œâ”€â”€ n9e/
    â”‚   â”œâ”€â”€ init-scripts/00-init-database.sql
    â”‚   â””â”€â”€ config/
    â”‚       â”œâ”€â”€ nightingale/config.toml
    â”‚       â””â”€â”€ categraf/conf.toml
    â”œâ”€â”€ grafana/datasources/clickhouse.yml
    â””â”€â”€ dataease/config/
        â”œâ”€â”€ application.yml
        â””â”€â”€ mysql.env
```

## ğŸ¯ æŠ€æœ¯äº®ç‚¹

1. **é…ç½®è‡ªåŒ…å«**: æ‰€æœ‰å¿…éœ€é…ç½®æ–‡ä»¶å·²çº³å…¥Gitç®¡ç†
2. **ä¸€é”®éƒ¨ç½²**: æ”¯æŒå®Œå…¨è‡ªåŠ¨åŒ–çš„ç¯å¢ƒæ­å»º
3. **å¥åº·æ£€æŸ¥**: å®Œå–„çš„æœåŠ¡ä¾èµ–å’Œå¥åº·æ£€æŸ¥æœºåˆ¶
4. **æ•…éšœè¯Šæ–­**: å…¨é¢çš„éªŒè¯å’Œè¯Šæ–­å·¥å…·
5. **æ–‡æ¡£å®Œå–„**: è¯¦ç»†çš„ä½¿ç”¨æŒ‡å—å’Œæ•…éšœæ’é™¤æ‰‹å†Œ

## ğŸ”„ ETLè‡ªåŠ¨å‘ç°åŠŸèƒ½

å¢å¼ºåçš„`integrated_ultra_etl_controller.py`æ”¯æŒï¼š
- **è‡ªåŠ¨æ–‡ä»¶æ‰«æ**: 3åˆ†é’Ÿé—´éš”æ£€æµ‹æ–°å¢æ—¥å¿—æ–‡ä»¶
- **ç¨³å®šæ€§æ£€æµ‹**: 30ç§’ç¨³å®šæ€§éªŒè¯é¿å…å¤„ç†ä¸å®Œæ•´æ–‡ä»¶
- **çº¿ç¨‹å®‰å…¨**: ä½¿ç”¨é”æœºåˆ¶ä¿æŠ¤å¹¶å‘å¤„ç†
- **åŸåŠŸèƒ½ä¿ç•™**: å®Œå…¨å…¼å®¹åŸæœ‰çš„äº¤äº’å¼å¤„ç†æµç¨‹

```python
# ä½¿ç”¨ç¤ºä¾‹
# 1. æ­£å¸¸å¤„ç†æ—¥å¿—æ–‡ä»¶
# 2. å¤„ç†å®Œæˆåé€‰æ‹©è¿›å…¥è‡ªåŠ¨ç›‘æ§æ¨¡å¼
# 3. åå°è‡ªåŠ¨æ‰«æå’Œå¤„ç†æ–°æ–‡ä»¶
# 4. å¯éšæ—¶é€€å‡ºè‡ªåŠ¨ç›‘æ§
```

## ğŸ“Š æ€§èƒ½æ•°æ®

- **Docker Composeä¼˜åŒ–**: æ–‡ä»¶å¤§å°å‡å°‘56% (1350â†’593è¡Œ)
- **æœåŠ¡å¯åŠ¨æ—¶é—´**: æ•°æ®åº“æœåŠ¡2-3åˆ†é’Ÿï¼ŒWebæœåŠ¡5-8åˆ†é’Ÿ
- **ç«¯å£ä½¿ç”¨**: ç²¾ç®€è‡³17ä¸ªæ ¸å¿ƒç«¯å£
- **å†…å­˜å ç”¨**: å»ºè®®8GBä»¥ä¸Šç³»ç»Ÿå†…å­˜

## ğŸ‰ é¡¹ç›®æˆæœ

âœ… **ä¸»è¦ç›®æ ‡è¾¾æˆ**: é€šè¿‡Gitå®ç°åŸºç¡€è®¾æ–½å³ä»£ç (Infrastructure as Code)
âœ… **å¿«é€Ÿéƒ¨ç½²**: æ–°ç”µè„‘ä¸Š5åˆ†é’Ÿå†…å®Œæˆç¯å¢ƒæ­å»º
âœ… **é…ç½®ç®¡ç†**: æ‰€æœ‰é…ç½®æ–‡ä»¶ç‰ˆæœ¬åŒ–ç®¡ç†
âœ… **è‡ªåŠ¨åŒ–ç¨‹åº¦**: æœ€å°åŒ–æ‰‹åŠ¨å¹²é¢„éœ€æ±‚
âœ… **æ–‡æ¡£å®Œå–„**: è¯¦ç»†çš„ä½¿ç”¨å’Œç»´æŠ¤æ–‡æ¡£

---

**æœ€åæ›´æ–°**: 2025-09-20
**ç‰ˆæœ¬**: v2.0 Gitéƒ¨ç½²ä¼˜åŒ–ç‰ˆ
**å…¼å®¹æ€§**: Docker Compose v2.x, Docker Engine 20.x+